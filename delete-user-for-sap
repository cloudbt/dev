# 既存のExcelインスタンスに接続
$excel = [Runtime.InteropServices.Marshal]::GetActiveObject("Excel.Application")

# 対象ブックを取得（開いている中から選択）
$workbook = $excel.Workbooks.Item(1)   # または $excel.Workbooks("book.xlsx")

# 1枚目のシートを取得
$sheet = $workbook.Sheets.Item(1)

# B列で最初の空セルを探す（1行目から下に向かって）
$row = 1
while ($sheet.Cells.Item($row, 2).Value2 -ne $null -and $sheet.Cells.Item($row, 2).Value2 -ne "") {
    $row++
}

# 見つけた空セルに値を設定
$sheet.Cells.Item($row, 2).Value2 = "新しい値"

# 保存（上書き）
$workbook.Save()
