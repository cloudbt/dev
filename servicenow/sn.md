

```
【背景】
① 性能改善対応（1/23リリース）
　SW情報マッピング処理を15分間隔対象外とし、HW情報のみ処理 → それでも約1時間かかる
② 短縮策の検討
　Last Seen（最終検知日時）で直近30分以内に絞る案を検討 → 1時間単位で一律更新のため絞り込み不可
③ Tanium社確認（青木様・有田様経由）
　Tanium Asset（SN連携データ）は1時間ごとにしか更新されない仕様と判明
```


```
例： 1:01に端末データが発生した場合

Tanium側：次回バッチ（2:00）まで待機 → 2:00に更新実行
ServiceNow側：次回ジョブ（2:15）まで待機 → 処理完了まで最大1時間

→ 1:01発生 〜 3:15頃反映完了 ＝ 最大約2時間の遅延が発生する可能性がある
```

# SG-Tanium運用における確認事項（1/2）

## 【依頼事項】

ServiceNow側で実施している **Tanium Assetデータの15分間隔取得（CMDB格納）**について、要件（新規端末を15分で検知・登録）を踏まえ、**現状の方式で継続すべきか**NHK様にご判断・ご相談させてください。

## 【目的】

* **MACアドレス連携**における「**15分間隔で新規端末を検知・登録したい**」要件を満たすための実現方法を整理する
* 取得方式・頻度の見直しにより、**処理時間（約1時間）/運用負荷**を抑えつつ、目的達成の確度を高める

## 【背景】

* 要件：ServiceNowへのMACアドレス連携において「**15分間隔で新規端末を検知・登録したい**」
* 現在：ServiceNowスケジュールジョブが **Tanium Assetデータを15分間隔**で取得し、CMDBへ格納
* しかし：上流（Tanium側のAsset DB更新）が **1時間単位**の場合、

  * ServiceNow側で15分間隔取得を続けても、**ServiceNowに反映される情報が更新されない（最新化しない）**
  * ＝目的（15分で新規端末検知・登録）に対して、方式として成立しない/効果が薄い可能性がある
* さらに：現状規模（約800台、HW情報のみの収集）でも **収集に約1時間**要しており、運用負荷も高い
* 参考（改善案の検討状況）：処理短縮のため、ServiceNow側スクリプトで **Last Seenを用いて直近30分以内に絞る**案を検討したが、ログ上はLast Seenが **1時間単位で揃って見える**ため、絞り込み効果が限定的な懸念がある

---

# SG-Tanium運用における確認事項（2/2）

## 【課題（ポイント）】

* 上流（Tanium側）が **1時間単位で更新**の場合、ServiceNow側で **15分間隔取得を続けても**

  * **ServiceNowに反映される情報が更新されない（最新化しない）**
  * ＝15分取得の目的（新規端末を15分で検知・登録）に対して、**実質的な効果が出にくい**
* さらに、現状の収集処理は（約800台、HW情報のみでも）**約1時間**かかっており、

  * 15分間隔運用は **処理の重なり/負荷増**につながる懸念
* 参考：処理短縮のための絞り込み（Last Seenで直近30分）も検討中だが、Last Seenが1時間単位で揃って見えるため、**絞り込み効果が限定的**な可能性

## 【NHK様に確認したいこと】

1. 「**15分間隔で新規端末を検知・登録**」要件について、

   * 必須（SLA/運用ルール上の根拠あり）か、
   * もしくは許容（例：30分〜1時間）可能か
2. 上流（Tanium側）が1時間更新の前提でも、

   * ServiceNow側の **15分間隔取得を継続すべき**か（継続しても最新化しない懸念あり）
   * 代替案（下記）の検討を進めてよいか

## 【代替案（方向性）】

* 取得頻度の見直し：15分 → **30分〜1時間**（上流更新周期に合わせる）
* 取得対象の絞り込み：新規端末検知に必要な最小項目に限定／別キーで差分判定を再検討
* 上流側の前提確認：Tanium→Asset DB→APIの更新周期（1時間更新が前提か、短縮の可否とリスク）

## 【決めたい結論】

* ServiceNow側の15分間隔取得を **継続する/見直す** の判断
* 見直す場合の、目標値（検知・登録までの許容時間）と実現方針


## 【NHK様に確認したいこと】

1. 「**15分間隔で新規端末を検知・登録**」要件について、

   * 必須（SLA/運用ルール上の根拠あり）か、
   * もしくは許容（例：30分〜1時間）可能か
2. 上流（Tanium側）が**1時間単位で更新**の前提でも、

   * ServiceNow側の **15分間隔取得を継続すべき**か（継続しても最新化しない懸念あり）
3. 15分継続が必須でない／要件緩和が可能な場合、以下の方向性で見直しを進めてよいか

   * 取得頻度の見直し：15分 → **30分〜1時間**（上流更新周期に合わせる）
   * 取得対象の絞り込み：新規端末検知に必要な最小項目に限定／別キーで差分判定を再検討
   * 上流側の前提確認：Tanium→Asset DB→APIの更新周期（1時間更新が前提か、短縮の可否とリスク）


## 【NHK様に確認したいこと】

1. **15分以内で新規端末を検知・登録**は必須要件でしょうか？（許容値：30分〜1時間でも可否）
2. 上流（Tanium側）が**1時間更新**の前提でも、ServiceNow側の**15分取得を継続**すべきでしょうか？
3. 継続が必須でない場合、**取得間隔の見直し（30分〜1時間）**または**取得方式の再検討**を進めてよいでしょうか？









分科会資料を作成いたします。

---

# ServiceNow-Tanium連携における データ取得間隔の見直しについて

## 1. 概要

ServiceNowとTanium間のデータ連携において、現行の15分間隔取得設定の妥当性について確認が必要な状況が判明しました。

## 2. 現状の課題

### 2.1 ServiceNow側の状況
- 現行設定：15分間隔でTanium Assetデータを取得
- 処理実績：約800台分のHW情報収集に約1時間を要している
- 取得完了前に次回取得がスタートする可能性あり

### 2.2 Tanium側の仕様（Aチーム・Tanium社回答より）

**データフロー**
```
Client → Core/TDS（ほぼリアルタイム） → Asset Database（定期バッチ） → REST API → ServiceNow
```

**確認された仕様**
- Asset DBへのデータ反映はTDSからの定期インポートによるスナップショット方式
- デフォルト更新間隔：1時間
- オンプレミス環境では1時間以上の間隔を推奨
- 1時間未満への変更は技術的には可能だが、推奨外のため利用者側での検証が必要

## 3. 問題点

ServiceNow側で15分間隔取得を行っても、Tanium Asset DB自体が1時間間隔でしか更新されないため、同一データを複数回取得することになり、実質的な効果が得られない。

| 項目 | ServiceNow設定 | Tanium仕様 | 結果 |
|------|---------------|-----------|------|
| 取得間隔 | 15分 | 1時間 | 不整合 |
| 期待する鮮度 | 15分以内 | 最大1時間 | 未達 |

## 4. 確認事項（NHK様へ）

**ServiceNow側で15分間隔での取得を継続する必要があるか、ご判断をお願いいたします。**

### 選択肢

| 案 | 内容 | メリット | デメリット |
|----|------|---------|-----------|
| A案 | ServiceNow側を1時間間隔に変更 | 処理負荷軽減、Tanium仕様と整合 | データ鮮度は最大1時間 |
| B案 | Tanium側を15分間隔に変更 | データ鮮度向上 | 推奨外設定、検証工数発生、性能影響懸念 |
| C案 | 現行維持（15分間隔） | 設定変更不要 | 実効性なし、処理負荷継続 |

## 5. 推奨案

**A案（ServiceNow側を1時間間隔に変更）** を推奨いたします。

理由：
- Taniumの推奨仕様に準拠
- ServiceNow側の処理負荷を軽減
- 追加の検証工数が不要

---

ご確認・ご判断のほど、よろしくお願いいたします。



会話内容を理解しました。Leaderさんからの追加検討事項を反映した資料を作成します。

---

# ServiceNow-Tanium連携における データ取得間隔の見直しについて

## 1. 概要

ServiceNowとTanium間のデータ連携において、現行の15分間隔取得設定の妥当性について確認が必要な状況が判明しました。

## 2. 現状の課題

### 2.1 ServiceNow側の状況
| 項目 | 内容 |
|------|------|
| 現行設定 | 15分間隔でTanium Assetデータを取得 |
| 処理実績 | 約800台分のHW情報収集に約1時間を要している |
| 問題点 | 取得完了前に次回取得がスタートする可能性あり |

### 2.2 Tanium側の仕様（Aチーム・Tanium社回答より確認済）

| 項目 | 内容 |
|------|------|
| データ反映方式 | TDSからの定期インポートによるスナップショット方式 |
| デフォルト更新間隔 | **1時間** |
| 推奨設定 | オンプレミス環境では1時間以上を推奨 |
| 備考 | 1時間未満への変更は技術的に可能だが、推奨外のため検証が必要 |

## 3. データフロー

```
[Client] ---(ほぼリアルタイム)---> [Core / TDS] ---(定期バッチ：1時間)---> [Asset DB] ---(REST API)---> [ServiceNow]
         
|<---------------- Tanium環境 ---------------->|                          |<-- ServiceNow -->|
```

### 課題
ServiceNow側で15分間隔取得を行っても、Tanium Asset DB自体が1時間間隔でしか更新されないため、同一データを複数回取得することになり、**実質的な効果が得られない**。

## 4. 確認事項（NHK様へ）

**ServiceNow側で15分間隔での取得を継続する必要があるか、ご判断をお願いいたします。**

### 選択肢

| 案 | 内容 | メリット | デメリット |
|----|------|---------|-----------|
| **A案（推奨）** | ServiceNow側を1時間間隔に変更 | 処理負荷軽減、Tanium仕様と整合、追加検証不要 | データ鮮度は最大1時間（※後述の懸念あり） |
| B案 | Tanium側を15分間隔に変更 | データ鮮度向上 | 推奨外設定、検証工数発生、性能影響懸念 |
| C案 | Tanium側からプッシュ方式に変更 | リアルタイム性向上の可能性 | ServiceNow側でテーブルAPI等の受け入れ実装が必要、Tanium側の対応可否要確認 |
| D案 | 現行維持（15分間隔） | 設定変更不要 | 実効性なし、処理負荷継続 |

## 5. 追加検討事項（タイミング同期の問題）

### 5.1 最悪ケースのシナリオ

A案（双方1時間間隔）を採用した場合でも、**タイミングのズレにより最大約2時間の遅延**が発生する可能性があります。

```
[端末でイベント発生]
        |
        v
[Tanium DBに登録] ←--- 最大59分待ち（次回バッチまで）
        |
        v
[Tanium DB更新完了]
        |
        v
[ServiceNow取得] ←--- 最大59分待ち（次回ジョブまで）
        |
        v
[ServiceNowに反映] 

合計：最大 約2時間の遅延
```

### 5.2 対策案

| 対策 | 内容 |
|------|------|
| タイミング同期 | Tanium側のDB更新タイミングに合わせて、ServiceNow側の取得ジョブを実行するよう調整 |
| 例 | Taniumが毎時00分に更新 → ServiceNowは毎時05分に取得開始 |

### 5.3 確認が必要な事項

- Tanium側のDB更新スケジュール（毎時何分に実行されるか）
- 上記スケジュールは固定か、変更可能か

## 6. 結論

1時間より早い間隔での収集は現実的ではないと考えられます。

**NHK様にご判断いただきたい事項：**
1. データ鮮度として1時間間隔で許容可能か
2. 許容可能な場合、タイミング同期の調整を行うか

---

ご確認・ご判断のほど、よろしくお願いいたします。

---

主な更新点：
- **C案（プッシュ方式）** を追加：テーブルAPIでの受け入れが必要になる点を記載
- **タイミング同期の問題** を追加：最悪ケースで約2時間の遅延が発生する懸念
- **対策案** を追加：TaniumのDB更新タイミングとServiceNowの取得タイミングを合わせる提案
