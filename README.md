# 

```
画像3（AWS org側での設定まとめ①）には2つの質問が表示されています。それぞれの質問に回答します：
質問1: 「リソースを絞ってよいか。」（EC2関連権限について）
回答：
はい、リソースを絞ることは可能です。セキュリティ観点からは、リソースを絞る方がベストプラクティスです。ただし、以下の点に注意してください：

EC2リソースに対して特定のインスタンスやイメージに制限する場合（arn:aws:ec2::864981734057:instance/*とarn:aws:ec2::864981734057:image/*）は、ServiceNowが必要とするすべてのEC2リソースにアクセスできることを確認してください。
将来的に新しいインスタンスやイメージが追加された場合でも、ポリシーが自動的にカバーするように設計されています（ワイルドカード*を使用しているため）。
リージョン指定がない形式（::の間が空白）になっていますが、これはすべてのリージョンを意味します。これで問題ありません。

質問2: 「メンバーアカウント側でListAccountsを実行できない。権限委任が必要？」（Organizations権限について）
回答：
はい、この点には注意が必要です。organizations:ListAccountsの権限はデフォルトでは管理アカウント（OrganizationsのマスターアカウントAWS Management account）でのみ有効です。メンバーアカウントでこの権限を使うには以下のアプローチが必要です：

管理アカウントでのロール作成が必要：画像5に示されている通り、管理アカウント（ID: 673147004060）にSnowOrganizationAccountAccessRoleというロールを作成し、そのロールにorganizations:ListAccountsなどの権限を付与します。
AssumeRole機能の使用：ServiceNowUserは、このロールを引き受ける（AssumeRole）ことで、間接的に管理アカウントの権限を使用できます。画像5のカスタム信頼ポリシーがこれを可能にします。
権限の委任方法：

まずメンバーアカウント（864981734057）のServiceNowUserは、管理アカウントのSnowOrganizationAccountAccessRoleを引き受けます
そしてそのロールの権限でorganizations:ListAccountsを実行します



この方法により、メンバーアカウントのユーザーが間接的にOrganizations情報にアクセスすることが可能になります。これは、画像2の「各メンバーアカウントへのアクセス設定 - SNOWユーザーがAssumeRoleで各メンバーアカウントのロールを引き受けるための設定」に該当する内容です。再試行C画像5: AWS org側での設定まとめ③（依頼予定）にある質問を回答してください。編集画像5（AWS org側での設定まとめ③）には2つの質問が表示されています。それぞれに回答します：
質問1：「Rootじゃなくて、IAMユーザーでも問題ないか？」
回答：
はい、RootユーザーではなくIAMユーザー（ServiceNowUser）を使用しても問題ありません。むしろ、セキュリティのベストプラクティスとしては、Root（ルートユーザー）は緊急時や初期設定のみに使用し、日常的な運用はIAMユーザーで行うことが推奨されています。以下の理由から、IAMユーザーを使用する方が適切です：

最小権限の原則：IAMユーザーには必要な権限のみを付与できるため、セキュリティリスクが低減されます。
監査とトレーサビリティ：IAMユーザーのアクションは個別に追跡・監査が可能です。
アクセスキー管理：ServiceNowとの連携ではアクセスキーが必要ですが、ルートユーザーのアクセスキーの使用は強く非推奨です。
クレデンシャル・ローテーション：IAMユーザーのアクセスキーは定期的に更新（ローテーション）できます。

具体的なユースケースであるAssumeRoleの実行も、適切な権限を持つIAMユーザーで問題なく行えます。
質問2：「2-1で付与した権限とこのSTSロールどちらがよいのでは？（どちらで取得する？）」
回答：
これは異なる目的のために両方が必要なケースです。以下のように使い分けるのが適切です：

2-1で付与した権限（SnowMemberAccountAccessPolicy）：

これはSNOW用集約アカウント（864981734057）内のEC2情報取得や、ServiceNowUser自身のアクセスキー管理（ローテーション）に必要です。
つまり、そのアカウント内で完結する操作に使用します。


管理アカウントのSTSロール（SnowOrganizationAccountAccessRole）：

これはOrganizations全体の情報（組織単位、アカウントリスト、組織構造など）を取得するために必要です。
特にorganizations:ListAccountsやorganizations:ListRootsなどの権限は、管理アカウント（673147004060）でのみ有効なため、このロールを使ってAssumeRoleする必要があります。



実際の使用フロー：

通常のEC2情報取得や自アカウント内の操作は、直接ServiceNowUserの権限で実行
Organizations全体の情報が必要な場合は、ServiceNowUserが管理アカウントのSTSロールをAssumeRoleして取得

このように、用途に応じて両方の権限セットを使い分けることで、最小権限の原則を守りながら必要な機能を実現できます。実装上はServiceNowの設定で、Organizations情報を取得する際にはAssumeRoleを使うように設定することになります。
```
